import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
// src/pages/RecommendedPlans.tsx
import React from 'react';
import Card from '../components/Card';
import NumberInput from '../components/NumberInput';
import { load, save } from '../lib/storage';
import { initialState } from '../lib/state';
import { useDebounceEffect } from '../lib/useDebounceEffect';
const fmt = (n) => n === undefined || Number.isNaN(n)
    ? '-'
    : n.toLocaleString('th-TH', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
export default function RecommendedPlans() {
    // ใช้ AppState เดียวกับ Engine เพื่อ sync อัตโนมัติ
    const [data, setData] = React.useState(() => load(initialState));
    useDebounceEffect(() => save(data), [data], 400);
    const ds = data.company.directors;
    const productName = 'My Style Legacy Ultra (Unitlinked)';
    const payYears = 7; // ✅ ค่าคงที่: ชำระเบี้ย 7 ปี เท่านั้น
    const updateDirector = (id, patch) => {
        setData(s => ({
            ...s,
            company: {
                ...s.company,
                directors: s.company.directors.map(d => (d.id === id ? { ...d, ...patch } : d)),
            },
        }));
    };
    // helpers
    const getSex = (d) => (d.sex === 'female' ? 'female' : 'male');
    const getAge = (d) => (typeof d.age === 'number' ? d.age : 35);
    const getSumAssured = (d) => (typeof d.sumAssured === 'number' ? d.sumAssured : 10000000);
    const getPremium = (d) => (typeof d.personalInsurancePremium === 'number' ? d.personalInsurancePremium : 200000);
    const getSurr = (d, key) => typeof d[key] === 'number' ? d[key] : undefined;
    const emptyState = ds.length === 0;
    return (_jsxs("main", { className: "mx-auto max-w-6xl px-6 py-10", children: [_jsx("h2", { className: "text-xl font-semibold text-gold mb-6", children: "\u0E41\u0E1C\u0E19\u0E01\u0E23\u0E21\u0E18\u0E23\u0E23\u0E21\u0E4C\u0E41\u0E19\u0E30\u0E19\u0E33" }), _jsxs("div", { className: "space-y-6", children: [_jsxs(Card, { title: "\u0E41\u0E1A\u0E1A\u0E1B\u0E23\u0E30\u0E01\u0E31\u0E19\u0E2F", children: [_jsx("div", { className: "grid grid-cols-1 gap-2 mb-3", children: _jsx("div", { className: "text-base md:text-lg font-semibold text-gold", children: productName }) }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4 items-end", children: [_jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)]", children: "\u0E0A\u0E33\u0E23\u0E30\u0E40\u0E1A\u0E35\u0E49\u0E22" }), _jsxs("div", { className: "mt-1 rounded-lg bg-white/5 px-3 py-2 ring-1 ring-white/10", children: [payYears, " \u0E1B\u0E35"] })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)]", children: "\u0E04\u0E38\u0E49\u0E21\u0E04\u0E23\u0E2D\u0E07\u0E16\u0E36\u0E07" }), _jsx("div", { className: "mt-1 rounded-lg bg-white/5 px-3 py-2 ring-1 ring-white/10", children: "\u0E2D\u0E32\u0E22\u0E38 99 \u0E1B\u0E35" })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)]", children: "\u0E17\u0E38\u0E19\u0E1B\u0E23\u0E30\u0E01\u0E31\u0E19\u0E0A\u0E35\u0E27\u0E34\u0E15 (\u0E02\u0E31\u0E49\u0E19\u0E15\u0E48\u0E33)" }), _jsx("div", { className: "mt-1 rounded-lg bg-white/5 px-3 py-2 ring-1 ring-white/10", children: "10,000,000 \u0E1A\u0E32\u0E17" })] })] }), _jsx("div", { className: "text-xs text-[color:var(--ink-dim)] mt-4", children: "* \u0E2B\u0E19\u0E49\u0E32\u0E19\u0E35\u0E49\u0E01\u0E33\u0E2B\u0E19\u0E14 \u201C\u0E17\u0E38\u0E19/\u0E40\u0E1A\u0E35\u0E49\u0E22/\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19\u201D \u0E23\u0E32\u0E22\u0E01\u0E23\u0E23\u0E21\u0E01\u0E32\u0E23 \u0E41\u0E25\u0E30\u0E0B\u0E34\u0E07\u0E04\u0E4C\u0E44\u0E1B Engine \u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34" })] }), emptyState && (_jsxs(Card, { title: "\u0E22\u0E31\u0E07\u0E44\u0E21\u0E48\u0E21\u0E35\u0E23\u0E32\u0E22\u0E0A\u0E37\u0E48\u0E2D\u0E01\u0E23\u0E23\u0E21\u0E01\u0E32\u0E23", children: [_jsxs("div", { className: "text-sm text-[color:var(--ink-dim)]", children: ["\u0E42\u0E1B\u0E23\u0E14\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E23\u0E32\u0E22\u0E0A\u0E37\u0E48\u0E2D\u0E01\u0E23\u0E23\u0E21\u0E01\u0E32\u0E23\u0E43\u0E19\u0E2B\u0E19\u0E49\u0E32 ", _jsx("span", { className: "text-gold", children: "Engine" }), " \u0E01\u0E48\u0E2D\u0E19 \u0E41\u0E25\u0E49\u0E27\u0E01\u0E25\u0E31\u0E1A\u0E21\u0E32\u0E2B\u0E19\u0E49\u0E32\u0E19\u0E35\u0E49\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E01\u0E33\u0E2B\u0E19\u0E14\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14\u0E23\u0E32\u0E22\u0E04\u0E19"] }), _jsx("a", { href: "/", className: "inline-block mt-3 text-xs px-3 py-1 rounded ring-1 ring-gold/50 hover:bg-gold/10", children: "\u0E44\u0E1B\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E23\u0E23\u0E21\u0E01\u0E32\u0E23\u0E43\u0E19 Engine" })] })), !emptyState && (_jsx("section", { className: "space-y-4", children: ds.map((d, idx) => {
                            const sex = getSex(d);
                            const age = getAge(d);
                            const sumAssured = getSumAssured(d);
                            const yearlyPremium = getPremium(d);
                            const surrY7 = getSurr(d, 'surrenderY7');
                            const surrAge60 = getSurr(d, 'surrenderAge60');
                            const surrAge70 = getSurr(d, 'surrenderAge70');
                            const surrAge99 = getSurr(d, 'surrenderAge99');
                            return (_jsxs("details", { className: "rounded-xl bg-white/5 ring-1 ring-white/10 p-4", open: idx === 0, children: [_jsxs("summary", { className: "flex items-center justify-between cursor-pointer select-none", children: [_jsxs("div", { className: "text-sm", children: [_jsx("span", { className: "text-[color:var(--ink-dim)]", children: "\u0E01\u0E23\u0E23\u0E21\u0E01\u0E32\u0E23:" }), ' ', _jsx("span", { className: "text-[color:var(--ink)] font-medium", children: d.name || `ผู้บริหาร ${idx + 1}` })] }), _jsx("div", { className: "text-xs text-[color:var(--ink-dim)]", children: "\u0E04\u0E25\u0E34\u0E01\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E14\u0E39/\u0E0B\u0E48\u0E2D\u0E19" })] }), _jsxs("div", { className: "mt-4 grid grid-cols-1 md:grid-cols-4 gap-4", children: [_jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E40\u0E1E\u0E28" }), _jsxs("div", { className: "flex items-center gap-4", children: [_jsxs("label", { className: "inline-flex items-center gap-2 cursor-pointer", children: [_jsx("input", { type: "radio", name: `sex-${d.id}`, className: "accent-gold", checked: sex === 'male', onChange: () => updateDirector(d.id, { sex: 'male' }) }), _jsx("span", { children: "\u0E0A\u0E32\u0E22" })] }), _jsxs("label", { className: "inline-flex items-center gap-2 cursor-pointer", children: [_jsx("input", { type: "radio", name: `sex-${d.id}`, className: "accent-gold", checked: sex === 'female', onChange: () => updateDirector(d.id, { sex: 'female' }) }), _jsx("span", { children: "\u0E2B\u0E0D\u0E34\u0E07" })] })] })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E2D\u0E32\u0E22\u0E38" }), _jsx("input", { type: "number", min: 1, max: 80, value: age, onChange: (e) => {
                                                            const v = Math.max(1, Math.min(80, Number(e.target.value)));
                                                            updateDirector(d.id, { age: v });
                                                        }, className: "w-full rounded-lg bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-gold/60", placeholder: "\u0E40\u0E0A\u0E48\u0E19 35" })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E17\u0E38\u0E19\u0E1B\u0E23\u0E30\u0E01\u0E31\u0E19\u0E0A\u0E35\u0E27\u0E34\u0E15 (\u0E1A\u0E32\u0E17)" }), _jsx(NumberInput, { value: sumAssured, onChange: (v) => updateDirector(d.id, { sumAssured: v ?? 0 }), placeholder: "\u0E40\u0E0A\u0E48\u0E19 10,000,000" })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E40\u0E1A\u0E35\u0E49\u0E22\u0E1B\u0E23\u0E30\u0E01\u0E31\u0E19 (\u0E1A\u0E32\u0E17/\u0E1B\u0E35)" }), _jsx(NumberInput, { value: yearlyPremium, onChange: (v) => updateDirector(d.id, { personalInsurancePremium: v ?? 0 }), placeholder: "\u0E40\u0E0A\u0E48\u0E19 200,000" })] })] }), _jsxs("div", { className: "mt-4 grid grid-cols-1 md:grid-cols-4 gap-4", children: [_jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19 \u0E1B\u0E35\u0E17\u0E35\u0E48 7" }), _jsx(NumberInput, { value: surrY7, onChange: (v) => updateDirector(d.id, { surrenderY7: v ?? undefined }) })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19 \u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2D\u0E32\u0E22\u0E38 60 \u0E1B\u0E35" }), _jsx(NumberInput, { value: surrAge60, onChange: (v) => updateDirector(d.id, { surrenderAge60: v ?? undefined }) })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19 \u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2D\u0E32\u0E22\u0E38 70 \u0E1B\u0E35" }), _jsx(NumberInput, { value: surrAge70, onChange: (v) => updateDirector(d.id, { surrenderAge70: v ?? undefined }) })] }), _jsxs("div", { children: [_jsx("div", { className: "text-sm text-[color:var(--ink-dim)] mb-1", children: "\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19\u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2A\u0E31\u0E0D\u0E0D\u0E32\u0E2D\u0E32\u0E22\u0E38 99 \u0E1B\u0E35" }), _jsx(NumberInput, { value: surrAge99, onChange: (v) => updateDirector(d.id, { surrenderAge99: v ?? undefined }) })] })] })] }, d.id));
                        }) })), !emptyState && (_jsxs(Card, { title: "\u0E20\u0E32\u0E1E\u0E23\u0E27\u0E21\u0E17\u0E38\u0E19 & \u0E40\u0E1A\u0E35\u0E49\u0E22 (\u0E17\u0E38\u0E01\u0E01\u0E23\u0E23\u0E21\u0E01\u0E32\u0E23) \u2022 \u0E2A\u0E21\u0E21\u0E38\u0E15\u0E34\u0E1C\u0E25\u0E15\u0E2D\u0E1A\u0E41\u0E17\u0E19\u0E08\u0E32\u0E01\u0E01\u0E32\u0E23\u0E25\u0E07\u0E17\u0E38\u0E19\u0E17\u0E35\u0E48 5%", children: [_jsx("div", { className: "overflow-x-auto", children: _jsxs("table", { className: "min-w-full text-sm table", children: [_jsx("thead", { className: "text-[color:var(--ink-dim)]", children: _jsxs("tr", { children: [_jsx("th", { className: "py-2 pr-3 text-left", children: "\u0E1C\u0E39\u0E49\u0E1A\u0E23\u0E34\u0E2B\u0E32\u0E23" }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E17\u0E38\u0E19\u0E1B\u0E23\u0E30\u0E01\u0E31\u0E19\u0E0A\u0E35\u0E27\u0E34\u0E15", _jsx("br", {}), "\u0E16\u0E36\u0E07\u0E2D\u0E32\u0E22\u0E38 99 \u0E1B\u0E35"] }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E40\u0E1A\u0E35\u0E49\u0E22/\u0E1B\u0E35", _jsx("br", {}), "\u0E1B\u0E35\u0E17\u0E35\u0E48 1"] }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E40\u0E1A\u0E35\u0E49\u0E22\u0E15\u0E25\u0E2D\u0E14\u0E2A\u0E31\u0E0D\u0E0D\u0E32", _jsx("br", {}), "\u0E04\u0E23\u0E1A\u0E1B\u0E35\u0E17\u0E35\u0E48 7"] }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19", _jsx("br", {}), "\u0E1B\u0E35\u0E17\u0E35\u0E48 7"] }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19", _jsx("br", {}), "\u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2D\u0E32\u0E22\u0E38 60 \u0E1B\u0E35"] }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19", _jsx("br", {}), "\u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2D\u0E32\u0E22\u0E38 70 \u0E1B\u0E35"] }), _jsxs("th", { className: "py-2 pr-3 text-right", children: ["\u0E21\u0E39\u0E25\u0E04\u0E48\u0E32\u0E23\u0E31\u0E1A\u0E0B\u0E37\u0E49\u0E2D\u0E04\u0E37\u0E19", _jsx("br", {}), "\u0E40\u0E21\u0E37\u0E48\u0E2D\u0E2D\u0E32\u0E22\u0E38 99 \u0E1B\u0E35"] })] }) }), _jsx("tbody", { className: "align-top", children: ds.map(d => {
                                                const sumAssured = getSumAssured(d);
                                                const yearlyPremium = getPremium(d);
                                                const accum7 = (yearlyPremium || 0) * 7;
                                                return (_jsxs("tr", { children: [_jsx("td", { className: "py-2 pr-3 text-left", children: d.name || '-' }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(sumAssured) }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(yearlyPremium) }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(accum7) }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(d.surrenderY7) }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(d.surrenderAge60) }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(d.surrenderAge70) }), _jsx("td", { className: "py-2 pr-3 text-right", children: fmt(d.surrenderAge99) })] }, d.id));
                                            }) })] }) }), _jsx("div", { className: "text-xs text-[color:var(--ink-dim)] mt-4", children: "* \u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E17\u0E35\u0E48\u0E41\u0E2A\u0E14\u0E07\u0E02\u0E49\u0E32\u0E07\u0E15\u0E49\u0E19\u0E04\u0E33\u0E19\u0E27\u0E13\u0E08\u0E32\u0E01\u0E2D\u0E31\u0E15\u0E23\u0E32\u0E1C\u0E25\u0E15\u0E2D\u0E1A\u0E41\u0E17\u0E19\u0E2A\u0E21\u0E21\u0E15\u0E34\u0E42\u0E14\u0E22\u0E40\u0E09\u0E25\u0E35\u0E48\u0E22\u0E15\u0E48\u0E2D\u0E1B\u0E35 5% \u0E08\u0E32\u0E01 \u0E41\u0E2D\u0E1B\u0E1E\u0E25\u0E34\u0E40\u0E04\u0E0A\u0E31\u0E48\u0E19 AZD" })] }))] })] }));
}
